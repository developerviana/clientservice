<po-page-default
  p-title="Alteração de Endereços de Clientes"
  [p-actions]="pageActions"
  [p-loading]="loading">

  <!-- Filtros de Busca -->
  <div class="po-row">
    <po-widget p-title="Filtros de Busca" class="po-md-12">
      <div class="po-row">
        <po-input
          class="po-md-4"
          name="filtroCodigo"
          p-label="Código do Cliente"
          [(ngModel)]="filtroCodigo"
          p-placeholder="Digite o código..."
          p-maxlength="6">
        </po-input>

        <po-input
          class="po-md-6"
          name="filtroNome"
          p-label="Nome do Cliente"
          [(ngModel)]="filtroNome"
          p-placeholder="Digite o nome..."
          p-maxlength="50">
        </po-input>

        <div class="po-md-2 po-mt-4">
          <po-button
            p-label="Buscar"
            p-icon="po-icon-search"
            p-type="primary"
            [p-loading]="loading"
            (p-click)="buscarClientes()">
          </po-button>
        </div>
      </div>
    </po-widget>
  </div>

  <!-- Tabela de Clientes -->
  <div class="po-row po-mt-2">
    <po-table
      class="po-md-12"
      p-striped="true"
      p-sort="true"
      p-hide-columns-manager="false"
      [p-columns]="columns"
      [p-items]="clientes"
      [p-actions]="actions"
      [p-loading]="loading"
      p-loading-text="Carregando clientes..."
      p-no-data-text="Nenhum cliente encontrado">
    </po-table>
  </div>

</po-page-default>

<!-- Modal de Alteração de Endereço -->
<po-modal
  [p-visible]="showModal"
  p-size="lg"
  [p-title]="modalTitle"
  p-primary-label="Salvar"
  p-secondary-label="Cancelar"
  [p-primary-loading]="loading"
  (p-primary-action)="salvarEndereco()"
  (p-secondary-action)="fecharModal()">

  <div class="po-row">
    <!-- Informações do Cliente -->
    <po-widget p-title="Dados do Cliente" class="po-md-12">
      <div class="po-row">
        <po-info
          class="po-md-3"
          p-label="Código"
          [p-value]="clienteSelecionado.codigo">
        </po-info>

        <po-info
          class="po-md-2"
          p-label="Loja"
          [p-value]="clienteSelecionado.loja">
        </po-info>

        <po-info
          class="po-md-7"
          p-label="Nome"
          [p-value]="clienteSelecionado.nome">
        </po-info>
      </div>
    </po-widget>
  </div>

  <div class="po-row po-mt-2">
    <!-- Busca por CEP -->
    <po-widget p-title="Buscar por CEP" class="po-md-12">
      <div class="po-row">
        <po-input
          class="po-md-4"
          name="cepBusca"
          p-label="CEP"
          [(ngModel)]="cepBusca"
          p-placeholder="00000-000"
          p-mask="99999-999"
          p-maxlength="9"
          (p-change)="formatarCEP($event)">
        </po-input>

        <div class="po-md-3 po-mt-4">
          <po-button
            p-label="Buscar CEP"
            p-icon="po-icon-search"
            p-type="primary"
            [p-loading]="loading"
            [p-disabled]="!cepBusca || cepBusca.length < 8"
            (p-click)="buscarCEP()">
          </po-button>
        </div>

        <div class="po-md-3 po-mt-4">
          <po-button
            p-label="Atualizar por CEP"
            p-icon="po-icon-ok"
            p-type="primary"
            [p-loading]="loading"
            [p-disabled]="!cepBusca || cepBusca.length < 8"
            (p-click)="atualizarPorCEP()">
          </po-button>
        </div>

        <div class="po-md-2 po-mt-4">
          <po-info
            p-label="ViaCEP"
            p-value="Integrado"
            p-type="success">
          </po-info>
        </div>
      </div>
    </po-widget>
  </div>

  <div class="po-row po-mt-2">
    <!-- Formulário de Endereço -->
    <po-widget p-title="Dados do Endereço" class="po-md-12">
      <div class="po-row">
        <po-input
          class="po-md-4"
          name="enderecoCep"
          p-label="CEP *"
          [(ngModel)]="endereco.cep"
          p-placeholder="00000-000"
          p-mask="99999-999"
          p-required="true"
          p-maxlength="9">
        </po-input>

        <po-input
          class="po-md-6"
          name="enderecoLogradouro"
          p-label="Logradouro *"
          [(ngModel)]="endereco.logradouro"
          p-placeholder="Rua, Avenida, etc..."
          p-required="true"
          p-maxlength="100">
        </po-input>

        <po-input
          class="po-md-2"
          name="enderecoNumero"
          p-label="Número"
          [(ngModel)]="endereco.numero"
          p-placeholder="123"
          p-maxlength="10">
        </po-input>
      </div>

      <div class="po-row po-mt-1">
        <po-input
          class="po-md-4"
          name="enderecoBairro"
          p-label="Bairro *"
          [(ngModel)]="endereco.bairro"
          p-placeholder="Nome do bairro"
          p-required="true"
          p-maxlength="50">
        </po-input>

        <po-input
          class="po-md-5"
          name="enderecoCidade"
          p-label="Cidade *"
          [(ngModel)]="endereco.localidade"
          p-placeholder="Nome da cidade"
          p-required="true"
          p-maxlength="50">
        </po-input>

        <po-select
          class="po-md-3"
          name="enderecoEstado"
          p-label="Estado *"
          [(ngModel)]="endereco.uf"
          p-required="true"
          [p-options]="[
            { label: 'AC - Acre', value: 'AC' },
            { label: 'AL - Alagoas', value: 'AL' },
            { label: 'AP - Amapá', value: 'AP' },
            { label: 'AM - Amazonas', value: 'AM' },
            { label: 'BA - Bahia', value: 'BA' },
            { label: 'CE - Ceará', value: 'CE' },
            { label: 'DF - Distrito Federal', value: 'DF' },
            { label: 'ES - Espírito Santo', value: 'ES' },
            { label: 'GO - Goiás', value: 'GO' },
            { label: 'MA - Maranhão', value: 'MA' },
            { label: 'MT - Mato Grosso', value: 'MT' },
            { label: 'MS - Mato Grosso do Sul', value: 'MS' },
            { label: 'MG - Minas Gerais', value: 'MG' },
            { label: 'PA - Pará', value: 'PA' },
            { label: 'PB - Paraíba', value: 'PB' },
            { label: 'PR - Paraná', value: 'PR' },
            { label: 'PE - Pernambuco', value: 'PE' },
            { label: 'PI - Piauí', value: 'PI' },
            { label: 'RJ - Rio de Janeiro', value: 'RJ' },
            { label: 'RN - Rio Grande do Norte', value: 'RN' },
            { label: 'RS - Rio Grande do Sul', value: 'RS' },
            { label: 'RO - Rondônia', value: 'RO' },
            { label: 'RR - Roraima', value: 'RR' },
            { label: 'SC - Santa Catarina', value: 'SC' },
            { label: 'SP - São Paulo', value: 'SP' },
            { label: 'SE - Sergipe', value: 'SE' },
            { label: 'TO - Tocantins', value: 'TO' }
          ]">
        </po-select>
      </div>

      <div class="po-row po-mt-1">
        <po-input
          class="po-md-12"
          name="enderecoComplemento"
          p-label="Complemento"
          [(ngModel)]="endereco.complemento"
          p-placeholder="Apartamento, sala, andar, etc..."
          p-maxlength="100">
        </po-input>
      </div>
    </po-widget>
  </div>

  <div class="po-row po-mt-2">
    <!-- Informações de Ajuda -->
    <po-widget p-title="Informações" class="po-md-12">
      <div class="po-row">
        <div class="po-md-12">
          <p><strong>Instruções:</strong></p>
          <ul>
            <li>Use o botão "Buscar CEP" para preencher automaticamente os campos via ViaCEP</li>
            <li>Use o botão "Atualizar por CEP" para aplicar diretamente via webservice</li>
            <li>Campos marcados com (*) são obrigatórios</li>
            <li>A alteração será feita via MsExecAuto CRMA980</li>
          </ul>
        </div>
      </div>
    </po-widget>
  </div>

</po-modal>
